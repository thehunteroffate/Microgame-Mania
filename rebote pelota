using System.Collections;
using System.Collections.Generic;
using UnityEngine;

public class Ballbounce : MonoBehaviour
{

    public GameObject hitP1;
    public GameObject hitP2;
    public GameObject hitTB;
    public GameObject hitTBB;
    public GameObject G1;
    public GameObject G2;

    public Ballmovement bm;
    public Score score;

    private void Bounce(Collision2D collision)
    {
        Vector3 bp = transform.position;
        Vector3 rp = collision.transform.position;
        float rh = collision.collider.bounds.size.y;

        float positionX = (collision.gameObject.name == "P1") ? 1 : -1;
        float positionY = (bp.y - rp.y) / rh;
        positionY = Mathf.Clamp(positionY, -0.75f, 0.75f);

        bm.increasehitcounter();
        bm.moveball(new Vector2(positionX, positionY));
    }

    private void OnCollisionEnter2D(Collision2D collision)
    {
        if (collision.gameObject.name == "P1")
        {
            Bounce(collision);
            Instantiate(hitP1, transform.position, transform.rotation);
        }

        else if (collision.gameObject.name == "P2")
        {
            Bounce(collision);
            Instantiate(hitP2, transform.position, transform.rotation);
        }

        else if (collision.gameObject.name == "TopBorder")
        {
            Instantiate(hitTB, transform.position, transform.rotation);
        }

        else if (collision.gameObject.name == "BottomBorder")
        {
            Instantiate(hitTBB, transform.position, transform.rotation);
        }

        else if (collision.gameObject.name == "LeftBorder")
        {
            score.P2G();
            bm.p1sr = false;
            StartCoroutine(bm.launch());
            Instantiate(G1, transform.position, transform.rotation);
        }

        else if (collision.gameObject.name == "RightBorder")
        {
            score.P1G();
            bm.p1sr = false;
            StartCoroutine(bm.launch());
            Instantiate(G2, transform.position, transform.rotation);
        }
    }

}
